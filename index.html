<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Aviation Connectivity - The Passenger Experience</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700;900&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    
    <!-- GSAP + ScrollTrigger -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <!-- Styles and Others -->
    <link rel="stylesheet" href="assets/style/passenger-experience.css">
    <link rel="stylesheet" href="assets/style/window-elements.css">
</head>
<body>
    
    <!-- SCROLL PROGRESS INDICATOR -->
    <div class="scroll-progress">
        <div class="progress-bar"></div>
    </div>

    <!-- MAIN CONTENT -->
    <main class="passenger-journey">
        
        <!-- SECTION 1: HERO WINDOW -->
        <section id="hero-window" class="window-section">
            <div class="window-container">
                <div class="airplane-window">
                    <div class="window-frame">
                        <div class="rivet rivet-tl"></div>
                        <div class="rivet rivet-tr"></div>
                        <div class="rivet rivet-bl"></div>
                        <div class="rivet rivet-br"></div>
                    </div>
                    <div class="window-view sky-gradient">
                        <div class="clouds-layer">
                            <div class="emoji-cloud cloud-1">‚òÅÔ∏è</div>
                            <div class="emoji-cloud cloud-2">‚òÅÔ∏è</div>
                            <div class="emoji-cloud cloud-3">‚òÅÔ∏è</div>
                            <div class="emoji-cloud cloud-4">‚òÅÔ∏è</div>
                            <div class="emoji-cloud cloud-5">‚òÅÔ∏è</div>
                        </div>
                        <div class="window-content">
                            <h1 class="hero-title">Where Can<br>You Fly?</h1>
                            <p class="hero-subtitle">Exploring Global Tourism Connectivity</p>
                            <div class="hero-meta">
                                <span>SUPSI Data Visualization</span>
                                <span class="separator"></span>
                                <span>2025</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="scroll-indicator">
                <span>Scroll to explore</span>
                <div class="scroll-arrow">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 5v14M5 12l7 7 7-7"/>
                    </svg>
                </div>
            </div>
        </section>

        <!-- SECTION 2: INTRODUCTION -->
        <section id="intro-section" class="content-section">
            <div class="section-inner">
                <div class="content-card glass-card">
                    <span class="section-number">01</span>
                    <h2>The World at Your Fingertips</h2>
                    <p class="lead-text">
                        Planning your next trip? The world has never been more accessible. 
                        International airports connect travelers to destinations across 
                        every continent, but not all countries are created equal when it 
                        comes to connectivity.
                    </p>
                    <p>
                        We analyzed flight route data from international airports worldwide 
                        to answer a simple question: <strong>how easy is it to travel from 
                        one country to another?</strong> The results reveal surprising patterns 
                        about which destinations are travel hubs, which are hidden gems, 
                        and which remain beautifully remote.
                    </p>
                </div>
                
                <div class="stats-row">
                    <div class="stat-card">
                        <span class="stat-value" data-count="195">0</span>
                        <span class="stat-label">Countries Analyzed</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" data-count="4000">0</span>
                        <span class="stat-label">International Airports</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" data-count="21000">0</span>
                        <span class="stat-label">Route Connections</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: TOP 10 + INTERACTIVE MAP (COMPACT) -->
        <section id="global-map-section" class="viz-section compact-section" data-scene="global">
            <div class="section-inner">
                
                <div class="content-card glass-card intro-card">
                    <span class="section-number">02</span>
                    <h2>Explore Global Connectivity</h2>
                    <p class="lead-text">
                        Click on any country to see where you can fly from there, 
                        or select from the top 10 most connected countries on the left.
                    </p>
                </div>
                
                <!-- Map Controls -->
                <div class="map-controls-bar">
                    <div class="control-group">
                        <label for="country-select">Select Country:</label>
                        <select id="country-select">
                            <option value="">Choose a destination...</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="max-routes">Show top routes:</label>
                        <input type="range" id="max-routes" min="5" max="50" value="20">
                        <span id="routes-value">20</span>
                    </div>
                    <div class="control-group buttons">
                        <button id="zoom-in" class="control-btn" title="Zoom In">+</button>
                        <button id="zoom-out" class="control-btn" title="Zoom Out">‚àí</button>
                        <button id="zoom-reset" class="control-btn" title="Reset View">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                                <path d="M3 3v5h5"/>
                            </svg>
                        </button>
                        <button id="reset-btn" class="control-btn text-btn">Clear</button>
                    </div>
                </div>
                
                <!-- Combined Top 10 + Map Layout (Compact) -->
                <div class="map-with-sidebar compact-layout">
                    <!-- Top 10 Sidebar -->
                    <div class="top10-sidebar">
                        <div class="sidebar-header">
                            <h4>Top 10 Connected</h4>
                            <span class="sidebar-subtitle">By countries reachable</span>
                        </div>
                        <div class="sidebar-ranking">
                            <div class="sidebar-item" data-country="France">
                                <span class="sidebar-rank">1</span>
                                <span class="sidebar-flag">üá´üá∑</span>
                                <span class="sidebar-name">France</span>
                                <span class="sidebar-count">115</span>
                            </div>
                            <div class="sidebar-item" data-country="United Kingdom">
                                <span class="sidebar-rank">2</span>
                                <span class="sidebar-flag">üá¨üáß</span>
                                <span class="sidebar-name">UK</span>
                                <span class="sidebar-count">99</span>
                            </div>
                            <div class="sidebar-item" data-country="Germany">
                                <span class="sidebar-rank">3</span>
                                <span class="sidebar-flag">üá©üá™</span>
                                <span class="sidebar-name">Germany</span>
                                <span class="sidebar-count">97</span>
                            </div>
                            <div class="sidebar-item" data-country="United States">
                                <span class="sidebar-rank">4</span>
                                <span class="sidebar-flag">üá∫üá∏</span>
                                <span class="sidebar-name">USA</span>
                                <span class="sidebar-count">92</span>
                            </div>
                            <div class="sidebar-item" data-country="Italy">
                                <span class="sidebar-rank">5</span>
                                <span class="sidebar-flag">üáÆüáπ</span>
                                <span class="sidebar-name">Italy</span>
                                <span class="sidebar-count">89</span>
                            </div>
                            <div class="sidebar-item" data-country="Netherlands">
                                <span class="sidebar-rank">6</span>
                                <span class="sidebar-flag">üá≥üá±</span>
                                <span class="sidebar-name">Nether...</span>
                                <span class="sidebar-count">84</span>
                            </div>
                            <div class="sidebar-item" data-country="Spain">
                                <span class="sidebar-rank">7</span>
                                <span class="sidebar-flag">üá™üá∏</span>
                                <span class="sidebar-name">Spain</span>
                                <span class="sidebar-count">83</span>
                            </div>
                            <div class="sidebar-item" data-country="Switzerland">
                                <span class="sidebar-rank">8</span>
                                <span class="sidebar-flag">üá®üá≠</span>
                                <span class="sidebar-name">Switzer...</span>
                                <span class="sidebar-count">81</span>
                            </div>
                            <div class="sidebar-item" data-country="Turkey">
                                <span class="sidebar-rank">9</span>
                                <span class="sidebar-flag">üáπüá∑</span>
                                <span class="sidebar-name">Turkey</span>
                                <span class="sidebar-count">78</span>
                            </div>
                            <div class="sidebar-item" data-country="Belgium">
                                <span class="sidebar-rank">10</span>
                                <span class="sidebar-flag">üáßüá™</span>
                                <span class="sidebar-name">Belgium</span>
                                <span class="sidebar-count">73</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Map Container -->
                    <div class="map-main">
                        <div class="seat-screen compact-screen">
                            <div class="screen-bezel">
                                <div id="d3-map-container" class="map-display">
                                    <div class="loading-indicator">
                                        <div class="loader"></div>
                                        <span>Loading map data...</span>
                                    </div>
                                </div>
                                <div id="info-panel" class="info-panel"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-links">
                    <a href="processed_data/country_connections_geo.json" class="data-link" download>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Dataset
                    </a>
                    <a href="protocols/viz_global_map.html" class="data-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Metadata &amp; Protocol
                    </a>
                </div>
                
            </div>
        </section>

        <!-- SECTION 4: HIDDEN GEMS & REMOTE (Compact, directly after map) -->
        <section id="gems-section" class="viz-section compact-section" data-scene="gems">
            <div class="section-inner">
                
                <div class="content-card glass-card intro-card">
                    <span class="section-number">03</span>
                    <h2>Hidden Gems &amp; Remote Destinations</h2>
                    <p class="lead-text">
                        Some destinations surprise with their connectivity, while others 
                        remain beautifully remote.
                    </p>
                </div>
                
                <div class="seat-screen gems-screen">
                    <div class="screen-bezel">
                        <div class="gems-display compact-gems">
                            <!-- Well-Connected Grid -->
                            <div class="gems-row">
                                <h4 class="gems-section-title">Surprisingly Well-Connected</h4>
                                <div class="gem-grid-compact">
                                    <div class="gem-card-mini" data-country="Qatar">
                                        <div class="gem-mini-header">
                                            <span class="gem-flag">üá∂üá¶</span>
                                            <div class="gem-mini-info">
                                                <span class="gem-region-tag">Middle East</span>
                                                <h5>Qatar</h5>
                                            </div>
                                        </div>
                                        <div class="gem-mini-stats">
                                            <span class="stat"><strong>68</strong> countries</span>
                                            <span class="stat"><strong>1</strong> airport</span>
                                        </div>
                                        <p class="gem-mini-insight">Single airport (Doha) connects to 68 countries ‚Äî one of the highest ratios worldwide.</p>
                                    </div>
                                    
                                    <div class="gem-card-mini" data-country="Portugal">
                                        <div class="gem-mini-header">
                                            <span class="gem-flag">üáµüáπ</span>
                                            <div class="gem-mini-info">
                                                <span class="gem-region-tag">Europe</span>
                                                <h5>Portugal</h5>
                                            </div>
                                        </div>
                                        <div class="gem-mini-stats">
                                            <span class="stat"><strong>56</strong> countries</span>
                                            <span class="stat"><strong>5</strong> airports</span>
                                        </div>
                                        <p class="gem-mini-insight">Gateway to Europe and former colonies in Africa and South America.</p>
                                    </div>
                                    
                                    <div class="gem-card-mini" data-country="Kenya">
                                        <div class="gem-mini-header">
                                            <span class="gem-flag">üá∞üá™</span>
                                            <div class="gem-mini-info">
                                                <span class="gem-region-tag">Africa</span>
                                                <h5>Kenya</h5>
                                            </div>
                                        </div>
                                        <div class="gem-mini-stats">
                                            <span class="stat"><strong>34</strong> countries</span>
                                            <span class="stat"><strong>3</strong> airports</span>
                                        </div>
                                        <p class="gem-mini-insight">East Africa's main hub. Nairobi connects to Europe, Middle East, and Asia.</p>
                                    </div>
                                    
                                    <div class="gem-card-mini" data-country="Panama">
                                        <div class="gem-mini-header">
                                            <span class="gem-flag">üáµüá¶</span>
                                            <div class="gem-mini-info">
                                                <span class="gem-region-tag">Central America</span>
                                                <h5>Panama</h5>
                                            </div>
                                        </div>
                                        <div class="gem-mini-stats">
                                            <span class="stat"><strong>35</strong> countries</span>
                                            <span class="stat"><strong>2</strong> airports</span>
                                        </div>
                                        <p class="gem-mini-insight">The "Hub of the Americas" ‚Äî connects North and South America like no other.</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Remote Destinations Row -->
                            <div class="gems-row remote-row">
                                <h4 class="gems-section-title">Off the Beaten Path</h4>
                                <div class="remote-grid-compact">
                                    <div class="remote-card-mini" data-country="Greenland">
                                        <span class="remote-flag">üá¨üá±</span>
                                        <div class="remote-text">
                                            <strong>Greenland</strong>
                                            <span>Connected to just <em>2 countries</em> ‚Äî world's largest island, hardest to reach.</span>
                                        </div>
                                    </div>
                                    <div class="remote-card-mini" data-country="Faroe Islands">
                                        <span class="remote-flag">üá´üá¥</span>
                                        <div class="remote-text">
                                            <strong>Faroe Islands</strong>
                                            <span>Only <em>3 connections</em> to these North Atlantic islands.</span>
                                        </div>
                                    </div>
                                    <div class="remote-card-mini" data-country="Tonga">
                                        <span class="remote-flag">üáπüá¥</span>
                                        <div class="remote-text">
                                            <strong>Tonga</strong>
                                            <span>Pacific kingdom connects to just <em>4 countries</em>.</span>
                                        </div>
                                    </div>
                                    <div class="remote-card-mini" data-country="Timor-Leste">
                                        <span class="remote-flag">üáπüá±</span>
                                        <div class="remote-text">
                                            <strong>East Timor</strong>
                                            <span>Southeast Asia's youngest nation: only <em>3 routes</em>.</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-links">
                    <a href="processed_data/country_stats.json" class="data-link" download>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Dataset
                    </a>
                    <a href="protocols/viz_gems.html" class="data-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Metadata &amp; Protocol
                    </a>
                </div>
                
            </div>
        </section>

        <!-- SECTION 5: COUNTRY CONNECTIONS NETWORK (Flourish) -->
        <section id="connections-network-section" class="viz-section" data-scene="network">
            <div class="section-inner">
                
                <div class="content-card glass-card intro-card">
                    <span class="section-number">04</span>
                    <h2>Country Connections Network</h2>
                    <p class="lead-text">
                        Which countries are most interconnected? This network visualization 
                        reveals the web of direct flight routes between nations.
                    </p>
                </div>
                
                <div class="seat-screen teammate-viz">
                    <div class="screen-bezel">
                        <div class="viz-embed-container" id="flourish-container">
                            <div class="flourish-embed flourish-network" data-src="visualisation/26452528">
                                <script src="https://public.flourish.studio/resources/embed.js"></script>
                                <noscript>
                                    <img src="https://public.flourish.studio/visualisation/26452528/thumbnail" width="100%" alt="network visualization" />
                                </noscript>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-links">
                    <a href="processed_data/country_connections.csv" class="data-link" download>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Dataset
                    </a>
                    <a href="protocols/viz_network.html" class="data-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Metadata &amp; Protocol
                    </a>
                </div>
                
                <div class="content-card glass-card analysis-card">
                    <h3>Reading the Network</h3>
                    <p>
                        Each node represents a country, and each link shows a direct flight connection. 
                        Notice how <strong>European countries cluster together</strong> with dense connections, 
                        while <strong>island nations appear at the periphery</strong> with fewer links.
                    </p>
                </div>
                
            </div>
        </section>

        <!-- SECTION 6: GLOBAL AIRPORTS MAP (Flourish - Replaces Tableau) -->
        <section id="airports-map-section" class="viz-section" data-scene="airports">
            <div class="section-inner">
                
                <div class="content-card glass-card intro-card">
                    <span class="section-number">05</span>
                    <h2>Global Airport Distribution</h2>
                    <p class="lead-text">
                        Explore the worldwide distribution of international airports and how 
                        they connect regions across the globe.
                    </p>
                </div>
                
                <div class="seat-screen teammate-viz">
                    <div class="screen-bezel">
                        <div class="viz-embed-container" id="flourish-map-container">
                            <div class="flourish-embed flourish-map" data-src="visualisation/26727077">
                                <script src="https://public.flourish.studio/resources/embed.js"></script>
                                <noscript>
                                    <img src="https://public.flourish.studio/visualisation/26727077/thumbnail" width="100%" alt="map visualization" />
                                </noscript>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-links">
                    <a href="processed_data/country_stats.json" class="data-link" download>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Dataset
                    </a>
                    <a href="protocols/viz_population.html" class="data-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Metadata &amp; Protocol
                    </a>
                </div>
                
                <div class="content-card glass-card analysis-card">
                    <h3>Key Observations</h3>
                    <ul class="insight-list">
                        <li>
                            <strong>Over-served:</strong> Northern Europe and small wealthy nations 
                            have disproportionately high airport density
                        </li>
                        <li>
                            <strong>Under-served:</strong> Large parts of Africa and South Asia 
                            lack adequate international air connectivity
                        </li>
                        <li>
                            <strong>Strategic hubs:</strong> Gulf states maximize global reach 
                            through concentrated mega-airports
                        </li>
                    </ul>
                </div>
                
            </div>
        </section>

        <!-- SECTION 7: CONTINENTAL AVIATION HUBS (Interactive Comparison) -->
        <section id="hub-section" class="viz-section" data-scene="hub">
            <div class="section-inner">
                
                <div class="content-card glass-card intro-card">
                    <span class="section-number">06</span>
                    <h2>Continental Aviation Hubs</h2>
                    <p class="lead-text">
                        Each continent has a leading aviation hub ‚Äî the busiest airport in its 
                        most connected country. Compare these <strong>6 global gateways</strong> 
                        to see how they shape international travel.
                    </p>
                </div>
                
                <div class="seat-screen hub-screen">
                    <div class="screen-bezel">
                        <div class="hub-display interactive-hub">
                            
                            <!-- Hub Multi-Selector -->
                            <div class="hub-selector-multi">
                                <div class="selector-header">
                                    <span class="selector-label">Compare Hubs:</span>
                                    <button class="select-all-btn" id="select-all-hubs">Select All</button>
                                </div>
                                <div class="hub-checkboxes">
                                    <label class="hub-checkbox active" data-hub="cdg">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üá´üá∑</span>
                                        <span class="checkbox-label">CDG</span>
                                        <span class="checkbox-region">Europe</span>
                                    </label>
                                    <label class="hub-checkbox active" data-hub="atl">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üá∫üá∏</span>
                                        <span class="checkbox-label">ATL</span>
                                        <span class="checkbox-region">N. America</span>
                                    </label>
                                    <label class="hub-checkbox active" data-hub="dxb">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üá¶üá™</span>
                                        <span class="checkbox-label">DXB</span>
                                        <span class="checkbox-region">Asia</span>
                                    </label>
                                    <label class="hub-checkbox active" data-hub="gru">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üáßüá∑</span>
                                        <span class="checkbox-label">GRU</span>
                                        <span class="checkbox-region">S. America</span>
                                    </label>
                                    <label class="hub-checkbox active" data-hub="cmn">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üá≤üá¶</span>
                                        <span class="checkbox-label">CMN</span>
                                        <span class="checkbox-region">Africa</span>
                                    </label>
                                    <label class="hub-checkbox active" data-hub="syd">
                                        <input type="checkbox" checked>
                                        <span class="checkbox-flag">üá¶üá∫</span>
                                        <span class="checkbox-label">SYD</span>
                                        <span class="checkbox-region">Oceania</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Dynamic Comparison Display -->
                            <div class="hub-comparison-wrapper">
                                <!-- Title changes based on selection -->
                                <div class="comparison-title" id="comparison-title">
                                    <h4>All Continental Hubs</h4>
                                    <span class="comparison-subtitle">Global Overview ‚Äî 6 airports across 6 continents</span>
                                </div>
                                
                                <!-- Comparison Cards Grid -->
                                <div class="hub-cards-grid" id="hub-cards-grid">
                                    <!-- CDG -->
                                    <div class="hub-card" data-hub="cdg">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üá´üá∑</span>
                                            <div class="hub-card-info">
                                                <strong>Paris CDG</strong>
                                                <span>Europe</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">70.3M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">115+</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- ATL -->
                                    <div class="hub-card" data-hub="atl">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üá∫üá∏</span>
                                            <div class="hub-card-info">
                                                <strong>Atlanta ATL</strong>
                                                <span>N. America</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">108.1M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">92</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- DXB -->
                                    <div class="hub-card" data-hub="dxb">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üá¶üá™</span>
                                            <div class="hub-card-info">
                                                <strong>Dubai DXB</strong>
                                                <span>Asia</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">92.3M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">91</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- GRU -->
                                    <div class="hub-card" data-hub="gru">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üáßüá∑</span>
                                            <div class="hub-card-info">
                                                <strong>S√£o Paulo GRU</strong>
                                                <span>S. America</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">43.6M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">33</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CMN -->
                                    <div class="hub-card" data-hub="cmn">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üá≤üá¶</span>
                                            <div class="hub-card-info">
                                                <strong>Casablanca CMN</strong>
                                                <span>Africa</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">10M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">48</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- SYD -->
                                    <div class="hub-card" data-hub="syd">
                                        <div class="hub-card-header">
                                            <span class="hub-card-flag">üá¶üá∫</span>
                                            <div class="hub-card-info">
                                                <strong>Sydney SYD</strong>
                                                <span>Oceania</span>
                                            </div>
                                        </div>
                                        <div class="hub-card-stats">
                                            <div class="mini-stat">
                                                <span class="mini-value">41.4M</span>
                                                <span class="mini-label">Passengers</span>
                                            </div>
                                            <div class="mini-stat">
                                                <span class="mini-value">34</span>
                                                <span class="mini-label">Countries</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Flourish Chart -->
                            <div class="hub-flourish-chart">
                                <div class="flourish-embed flourish-chart" data-src="visualisation/26746807">
                                    <script src="https://public.flourish.studio/resources/embed.js"></script>
                                    <noscript>
                                        <img src="https://public.flourish.studio/visualisation/26746807/thumbnail" width="100%" alt="Monthly flights comparison chart" />
                                    </noscript>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-links">
                    <a href="processed_data/continental_hubs_2024.json" class="data-link" download>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        Dataset
                    </a>
                    <a href="protocols/viz_continental_hubs.html" class="data-link">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14,2 14,8 20,8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                        </svg>
                        Metadata &amp; Protocol
                    </a>
                </div>
                
            </div>
        </section>

        <!-- SECTION 8: KEY FINDINGS & NEXT STEPS -->
        <section id="findings-section" class="content-section">
            <div class="section-inner">
                
                <div class="content-card glass-card large-card">
                    <span class="section-number">07</span>
                    <h2>What We Learned</h2>
                    
                    <div class="findings-grid">
                        <div class="finding-card">
                            <div class="finding-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M2 12h20"/>
                                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                                </svg>
                            </div>
                            <h4>Europe Leads</h4>
                            <p>
                                European countries dominate the top 10 most connected list, 
                                benefiting from geographic proximity, open skies agreements, 
                                and strong tourism industries.
                            </p>
                        </div>
                        
                        <div class="finding-card">
                            <div class="finding-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                                </svg>
                            </div>
                            <h4>Geography Matters</h4>
                            <p>
                                Countries positioned between continents (Turkey, UAE, Panama) 
                                leverage their location to become travel crossroads, regardless 
                                of population size.
                            </p>
                        </div>
                        
                        <div class="finding-card">
                            <div class="finding-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                    <circle cx="9" cy="7" r="4"/>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                </svg>
                            </div>
                            <h4>Inequality Persists</h4>
                            <p>
                                Access to international travel remains highly unequal. 
                                Some island nations have only 1-2 connections, leaving 
                                residents with limited mobility options.
                            </p>
                        </div>
                        
                        <div class="finding-card">
                            <div class="finding-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                    <polyline points="3.27,6.96 12,12.01 20.73,6.96"/>
                                    <line x1="12" y1="22.08" x2="12" y2="12"/>
                                </svg>
                            </div>
                            <h4>Hub Strategy Works</h4>
                            <p>
                                Smaller countries can achieve outsized connectivity by investing 
                                in a single world-class hub. Qatar reaches 68 countries from 
                                just one airport.
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- NEXT STEPS -->
                <div class="content-card glass-card next-steps-card">
                    <h2>Next Steps</h2>
                    <p class="lead-text">
                        This analysis opens doors for further exploration:
                    </p>
                    
                    <div class="next-steps-grid">
                        <div class="next-step">
                            <span class="step-icon">üìà</span>
                            <div class="step-content">
                                <h4>Temporal Analysis</h4>
                                <p>Track how connectivity patterns change over seasons, years, and post-pandemic recovery trends.</p>
                            </div>
                        </div>
                        <div class="next-step">
                            <span class="step-icon">üí∞</span>
                            <div class="step-content">
                                <h4>Cost Correlation</h4>
                                <p>Investigate the relationship between connectivity and average flight prices to understand accessibility beyond availability.</p>
                            </div>
                        </div>
                        <div class="next-step">
                            <span class="step-icon">üå±</span>
                            <div class="step-content">
                                <h4>Environmental Impact</h4>
                                <p>Map carbon emissions per route and explore sustainable aviation trends.</p>
                            </div>
                        </div>
                        <div class="next-step">
                            <span class="step-icon">üîÆ</span>
                            <div class="step-content">
                                <h4>Future Predictions</h4>
                                <p>Model emerging routes and predict which countries will become the next major hubs.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>

        <!-- SECTION 9: FINALE WINDOW -->
        <section id="finale-window" class="window-section finale">
            <div class="window-container">
                <div class="airplane-window">
                    <div class="window-frame">
                        <div class="rivet rivet-tl"></div>
                        <div class="rivet rivet-tr"></div>
                        <div class="rivet rivet-bl"></div>
                        <div class="rivet rivet-br"></div>
                    </div>
                    <div class="window-view sunset-scene">
                        <div class="sunset-sky"></div>
                        <div class="sun-glow"></div>
                        <div class="sunset-clouds-layer">
                            <div class="sunset-cloud cloud-1">‚òÅÔ∏è</div>
                            <div class="sunset-cloud cloud-2">‚òÅÔ∏è</div>
                            <div class="sunset-cloud cloud-3">‚òÅÔ∏è</div>
                            <div class="sunset-cloud cloud-4">‚òÅÔ∏è</div>
                        </div>
                        <div class="ocean-layer">
                            <div class="ocean-reflection"></div>
                        </div>
                        <div class="finale-content">
                            <h2>Bon Voyage</h2>
                            <p class="finale-tagline">
                                The world awaits. Where will you go?
                            </p>
                        </div>
                        <div class="credits">
                            <div class="credits-title">A SUPSI Data Visualization Project</div>
                            <div class="credits-team">
                                <span class="credit-name">Alan Dominguez</span>
                                <span class="credit-name">Rafaela Dos Santos Farina</span>
                                <span class="credit-name">Colin Augustine</span>
                            </div>
                            <div class="credits-prof">Professor Giovanni Profeta</div>
                            <div class="credits-year">December 2025</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- TOOLTIP -->
    <div id="map-tooltip" class="map-tooltip"></div>

    <!-- Interactive Features Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // ==========================================
            // 1. HUB DATA
            // ==========================================
            const hubData = {
                cdg: { name: 'Paris CDG', fullName: 'Charles de Gaulle', region: 'Europe', flag: 'üá´üá∑', passengers: '70.3M', countries: '115+' },
                atl: { name: 'Atlanta ATL', fullName: 'Hartsfield-Jackson', region: 'N. America', flag: 'üá∫üá∏', passengers: '108.1M', countries: '92' },
                dxb: { name: 'Dubai DXB', fullName: 'Dubai International', region: 'Asia', flag: 'üá¶üá™', passengers: '92.3M', countries: '91' },
                gru: { name: 'S√£o Paulo GRU', fullName: 'Guarulhos', region: 'S. America', flag: 'üáßüá∑', passengers: '43.6M', countries: '33' },
                cmn: { name: 'Casablanca CMN', fullName: 'Mohammed V', region: 'Africa', flag: 'üá≤üá¶', passengers: '10M', countries: '48' },
                syd: { name: 'Sydney SYD', fullName: 'Kingsford Smith', region: 'Oceania', flag: 'üá¶üá∫', passengers: '41.4M', countries: '34' }
            };
            
            // ==========================================
            // 2. HUB MULTISELECT SYSTEM
            // ==========================================
            const hubCheckboxes = document.querySelectorAll('.hub-checkbox');
            const hubCards = document.querySelectorAll('.hub-card');
            const comparisonTitle = document.getElementById('comparison-title');
            const selectAllBtn = document.getElementById('select-all-hubs');
            
            // Get selected hubs
            function getSelectedHubs() {
                const selected = [];
                hubCheckboxes.forEach(cb => {
                    if (cb.querySelector('input').checked) {
                        selected.push(cb.dataset.hub);
                    }
                });
                return selected;
            }
            
            // Update display based on selection
            function updateHubDisplay() {
                const selected = getSelectedHubs();
                
                // Update checkbox visual state
                hubCheckboxes.forEach(cb => {
                    const isChecked = cb.querySelector('input').checked;
                    cb.classList.toggle('active', isChecked);
                });
                
                // Update cards visibility
                hubCards.forEach(card => {
                    const hubId = card.dataset.hub;
                    const isSelected = selected.includes(hubId);
                    card.classList.toggle('hidden', !isSelected);
                    card.classList.toggle('visible', isSelected);
                });
                
                // Update title
                updateComparisonTitle(selected);
                
                // Update Select All button text
                if (selected.length === 6) {
                    selectAllBtn.textContent = 'Deselect All';
                } else {
                    selectAllBtn.textContent = 'Select All';
                }
            }
            
            // Update comparison title
            function updateComparisonTitle(selected) {
                if (!comparisonTitle) return;
                
                const h4 = comparisonTitle.querySelector('h4');
                const subtitle = comparisonTitle.querySelector('.comparison-subtitle');
                
                if (selected.length === 0) {
                    h4.textContent = 'No Hubs Selected';
                    subtitle.textContent = 'Select at least one hub to compare';
                } else if (selected.length === 6) {
                    h4.textContent = 'All Continental Hubs';
                    subtitle.textContent = 'Global Overview ‚Äî 6 airports across 6 continents';
                } else if (selected.length === 1) {
                    const hub = hubData[selected[0]];
                    h4.textContent = hub.fullName;
                    subtitle.textContent = `${hub.flag} ${hub.region} Hub`;
                } else {
                    // Multiple but not all - show "vs" format
                    const names = selected.map(id => hubData[id].name.split(' ')[0]);
                    h4.textContent = names.join(' vs ');
                    subtitle.textContent = `Comparing ${selected.length} continental hubs`;
                }
            }
            
            // Checkbox click handlers
            hubCheckboxes.forEach(cb => {
                cb.addEventListener('click', function(e) {
                    // Toggle checkbox state
                    const input = this.querySelector('input');
                    input.checked = !input.checked;
                    e.preventDefault();
                    
                    // Ensure at least one is selected
                    const selected = getSelectedHubs();
                    if (selected.length === 0) {
                        input.checked = true;
                    }
                    
                    updateHubDisplay();
                });
            });
            
            // Select All button
            if (selectAllBtn) {
                selectAllBtn.addEventListener('click', function() {
                    const selected = getSelectedHubs();
                    const shouldSelectAll = selected.length < 6;
                    
                    hubCheckboxes.forEach(cb => {
                        cb.querySelector('input').checked = shouldSelectAll;
                    });
                    
                    updateHubDisplay();
                });
            }
            
            // Function to select specific hubs (for external control)
            window.selectHubs = function(hubIds) {
                if (!Array.isArray(hubIds)) hubIds = [hubIds];
                
                hubCheckboxes.forEach(cb => {
                    const input = cb.querySelector('input');
                    input.checked = hubIds.includes(cb.dataset.hub);
                });
                
                // Ensure at least one is selected
                if (getSelectedHubs().length === 0) {
                    hubCheckboxes[0].querySelector('input').checked = true;
                }
                
                updateHubDisplay();
            };
            
            // Legacy single select (for compatibility)
            window.selectHub = function(hubId) {
                window.selectHubs([hubId]);
            };
            
            // ==========================================
            // 3. HIDDEN GEMS - Click to show on D3 Map
            // ==========================================
            const gemCards = document.querySelectorAll('.gem-card-mini[data-country], .remote-card-mini[data-country]');
            
            gemCards.forEach(card => {
                card.style.cursor = 'pointer';
                card.addEventListener('click', function() {
                    const country = this.dataset.country;
                    if (country && typeof window.selectCountry === 'function') {
                        // Scroll to map section
                        const mapSection = document.getElementById('global-map-section');
                        if (mapSection) {
                            mapSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                        // Select country on D3 map
                        setTimeout(() => {
                            window.selectCountry(country);
                        }, 800);
                    }
                });
            });
            
            // ==========================================
            // 4. FLOURISH SYNC
            // ==========================================
            const flourishToHubMap = {
                'Charles de Gaulle': 'cdg',
                'Paris': 'cdg',
                'CDG': 'cdg',
                'France': 'cdg',
                'Hartsfield-Jackson Atlanta': 'atl',
                'Atlanta': 'atl',
                'ATL': 'atl',
                'USA': 'atl',
                'Dubai International': 'dxb',
                'Dubai': 'dxb',
                'DXB': 'dxb',
                'UAE': 'dxb',
                'Guarulhos International': 'gru',
                'S√£o Paulo': 'gru',
                'Sao Paulo': 'gru',
                'GRU': 'gru',
                'Brazil': 'gru',
                'Mohammed V International': 'cmn',
                'Casablanca': 'cmn',
                'CMN': 'cmn',
                'Morocco': 'cmn',
                'Sydney Kingsford Smith': 'syd',
                'Sydney': 'syd',
                'SYD': 'syd',
                'Australia': 'syd'
            };
            
            // Sync from Flourish selection (multiple selections)
            window.syncHubsFromFlourish = function(selections) {
                if (!Array.isArray(selections)) selections = [selections];
                
                const hubIds = selections
                    .map(s => flourishToHubMap[s])
                    .filter(id => id !== undefined);
                
                if (hubIds.length > 0) {
                    window.selectHubs(hubIds);
                }
            };
            
            // Legacy single sync
            window.syncHubFromFlourish = function(selection) {
                const hubId = flourishToHubMap[selection];
                if (hubId) {
                    // Add to current selection instead of replacing
                    const current = getSelectedHubs();
                    if (!current.includes(hubId)) {
                        current.push(hubId);
                        window.selectHubs(current);
                    }
                }
            };
            
            // Listen for postMessage from Flourish
            window.addEventListener('message', function(event) {
                if (event.origin.includes('flourish.studio') || event.origin.includes('public.flourish.studio')) {
                    try {
                        const data = typeof event.data === 'string' ? JSON.parse(event.data) : event.data;
                        
                        if (data.type === 'selection' || data.action === 'select') {
                            const selection = data.value || data.label || data.name || data.airport;
                            if (selection) {
                                if (Array.isArray(selection)) {
                                    window.syncHubsFromFlourish(selection);
                                } else {
                                    window.syncHubFromFlourish(selection);
                                }
                            }
                        }
                    } catch (e) {
                        // Not a JSON message, ignore
                    }
                }
            });
            
            // ==========================================
            // 5. EXPOSE API
            // ==========================================
            window.PassengerExperience = {
                selectHub: window.selectHub,
                selectHubs: window.selectHubs,
                getSelectedHubs: getSelectedHubs,
                syncHubFromFlourish: window.syncHubFromFlourish,
                syncHubsFromFlourish: window.syncHubsFromFlourish,
                hubData: hubData,
                hubMapping: flourishToHubMap
            };
            
            // Initialize display
            updateHubDisplay();
            
            console.log('‚úàÔ∏è Passenger Experience: Interactive features loaded');
            console.log('   - Hub multiselect ready');
            console.log('   - Hidden gems clickable');
            console.log('   - Flourish sync prepared');
        });
    </script>

    <!-- JavaScript -->
    <script src="assets/script/map-controller.js"></script>
    <script src="assets/script/passenger-scroll.js"></script>

</body>
</html>
